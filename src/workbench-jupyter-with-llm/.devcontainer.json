{
  "name": "Navid Workbench Jupyter",
  "dockerComposeFile": ["docker-compose.yaml", "../jupyter-common/jupyter-common-compose.yaml"],
  "service": "app",
  "runServices": ["app"],
  "shutdownAction": "none",
  "workspaceFolder": "/workspace",
  "postCreateCommand": [
    "bash",
    "-c",
    "./startupscript/post-startup.sh jupyter /home/jupyter \"${templateOption:cloud}\" \"${templateOption:login}\" && echo '' >> /home/jupyter/.bashrc && echo '# Unset GOOGLE_CLOUD_PROJECT for Gemini CLI compatibility' >> /home/jupyter/.bashrc && echo 'unset GOOGLE_CLOUD_PROJECT' >> /home/jupyter/.bashrc"
  ],
  // re-mount bucket files on container start up, then generate LLM context
  "postStartCommand": [
    "bash",
    "-c",
    "./startupscript/remount-on-restart.sh jupyter /home/jupyter \"${templateOption:cloud}\" \"${templateOption:login}\"; /opt/llm-context/generate-context.sh /home/jupyter || true"
  ],
  "features": {
    "./.devcontainer/features/workbench-tools": {
      "cloud": "${templateOption:cloud}",
      "username": "jupyter",
      "userHomeDir": "/home/jupyter"
    },
    "./.devcontainer/features/gemini": {
      "version": "latest",
      "username": "jupyter",
      "userHomeDir": "/home/jupyter"
    },
    "ghcr.io/anthropics/devcontainer-features/claude-code:1.0": {},
    "./.devcontainer/features/wb-mcp-server": {
      "username": "jupyter",
      "userHomeDir": "/home/jupyter"
    },
    "./.devcontainer/features/llm-context": {
      "username": "jupyter",
      "userHomeDir": "/home/jupyter"
    }
  },
  "remoteUser": "root",
  "customizations": {
    "workbench": {
      "opens": {
        "extensions": [
          // Source
          ".ipynb",
          ".R",
          ".py",
          // Documents
          ".md",
          ".html",
          ".latex",
          ".pdf",
          // Images
          ".bmp",
          ".gif",
          ".jpeg",
          ".jpg",
          ".png",
          ".svg",
          // Data
          ".csv",
          ".tsv",
          ".json",
          ".vl"
        ],
        "fileUrlSuffix": "/lab/tree/{path}",
        "folderUrlSuffix": "/lab/tree/{path}"
      }
    }
  }
}
